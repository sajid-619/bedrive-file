{"version":3,"mappings":"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","names":["Endpoint","useAdminReport","payload","useQuery","fetchAnalyticsReport","types","dateRange","params","apiClient","response","ChartLayout","props","title","description","children","className","contentIsFlex","contentClassName","contentRef","minHeight","jsxs","clsx","jsx","ChartLoadingIndicator","ProgressCircle","Trans","LazyChart","lazy","BaseChart","isLoading","Suspense","formatReportData","report","localeCode","shareFirstDatasetLabels","firstDatasetLabels","dataset","datasetIndex","data","datasetItem","itemIndex","label","generateDatasetLabels","datum","granularity","locale","generateTimeLabels","isoDate","isoEndDate","value","date","parseAbsoluteToLocal","endDate","getFormatter","memoize","options","DateFormatter","a","b","shallowEqual","primaryColor","getBootstrapData","ChartColors","LineChartOptions","LineChart","useSelectedLocale","formattedData","useMemo","i","PolarAreaChartOptions","PolarAreaChart","d","c","BarChart","direction","individualBarColors","isHorizontal","loaderUrl","useGoogleGeoChart","placeholderRef","country","onCountrySelected","trans","useTrans","analytics","useSettings","apiKey","selectedTheme","useThemeSelector","geoChartRef","useRef","regionInteractivity","drawGoogleChart","useCallback","seedData","location","message","backgroundColor","themeValueToHex","_a","_b","initGoogleGeoChart","lazyLoader","useEffect","InfoDialogTriggerIcon","createSvgIcon","InfoDialogTrigger","body","dialogSize","DialogTrigger","IconButton","Dialog","DialogHeader","DialogBody","FormattedCountryName","memo","countryCode","regionNames","formattedName","Fragment","GeoChart","metricData","layoutProps","initialData","InfoTrigger","Button","ArrowBackIcon","AdminReportPageColGap","rowClassName","VisitorsReportCharts","totalViews","FormattedNumber","AdminHeaderReport","FormattedDateTimeRange","ValueMetricItem","Icon","createSvgIconFromTree","FormattedBytes","TrendingIndicator","percentage","icon","TrendingUpIcon","TrendingFlatIcon","TrendingDownIcon","monthDayFormat","ReportDateSelector","onChange","compactOnMobile","isMobile","useIsMobileMediaQuery","DateRangeIcon","DateFormatPresets","DateSelectorDialog","state","useDateRangePickerState","DateRangeDialog","AdminReportPage","setDateRange","useState","DateRangePresets","StaticPageTitle"],"sources":["../../../common/resources/client/admin/analytics/use-admin-report.ts","../../../common/resources/client/charts/chart-layout.tsx","../../../common/resources/client/charts/chart-loading-indicator.tsx","../../../common/resources/client/charts/base-chart.tsx","../../../common/resources/client/charts/data/format-report-data.ts","../../../common/resources/client/charts/chart-colors.tsx","../../../common/resources/client/charts/line-chart.tsx","../../../common/resources/client/charts/polar-area-chart.tsx","../../../common/resources/client/charts/bar-chart.tsx","../../../common/resources/client/admin/analytics/geo-chart/use-google-geo-chart.ts","../../../common/resources/client/ui/overlays/dialog/info-dialog-trigger/info-dialog-trigger-icon.tsx","../../../common/resources/client/ui/overlays/dialog/info-dialog-trigger/info-dialog-trigger.tsx","../../../common/resources/client/i18n/formatted-country-name.tsx","../../../common/resources/client/admin/analytics/geo-chart/geo-chart.tsx","../../../common/resources/client/admin/analytics/visitors-report-charts.tsx","../../../common/resources/client/admin/analytics/admin-header-report.tsx","../../../common/resources/client/admin/analytics/report-date-selector.tsx","../../../common/resources/client/admin/analytics/admin-report-page.tsx"],"sourcesContent":["import {useQuery} from '@tanstack/react-query';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {apiClient} from '../../http/query-client';\nimport {VisitorsReportData} from './visitors-report-data';\nimport {IconTree} from '../../icons/create-svg-icon';\nimport {DateRangeValue} from '@common/ui/forms/input-field/date/date-range-picker/date-range-value';\n\nconst Endpoint = 'admin/reports';\n\nexport interface HeaderDatum {\n  icon: IconTree[];\n  name: string;\n  type?: 'number' | 'fileSize';\n  currentValue: number;\n  previousValue?: number;\n  percentageChange?: number;\n}\n\ninterface FetchAnalyticsReportResponse extends BackendResponse {\n  visitorsReport: VisitorsReportData;\n  headerReport: HeaderDatum[];\n}\n\ninterface Payload {\n  types?: ('visitors' | 'header')[];\n  dateRange?: DateRangeValue;\n}\nexport function useAdminReport(payload: Payload = {}) {\n  return useQuery([Endpoint, payload], () => fetchAnalyticsReport(payload), {\n    keepPreviousData: true,\n  });\n}\n\nfunction fetchAnalyticsReport({\n  types,\n  dateRange,\n}: Payload): Promise<FetchAnalyticsReportResponse> {\n  const params: Record<string, any> = {};\n  if (types) {\n    params.types = types.join(',');\n  }\n  if (dateRange) {\n    params.startDate = dateRange.start.toAbsoluteString();\n    params.endDate = dateRange.end.toAbsoluteString();\n    params.timezone = dateRange.start.timeZone;\n  }\n  return apiClient.get(Endpoint, {params}).then(response => response.data);\n}\n","import {ReactNode, Ref} from 'react';\nimport clsx from 'clsx';\n\nexport interface ChartLayoutProps {\n  title: ReactNode;\n  description?: ReactNode;\n  className?: string;\n  children: ReactNode;\n  contentIsFlex?: boolean;\n  contentClassName?: string;\n  minHeight?: string;\n  contentRef?: Ref<HTMLDivElement>;\n  isLoading?: boolean;\n}\nexport function ChartLayout(props: ChartLayoutProps) {\n  const {\n    title,\n    description,\n    children,\n    className,\n    contentIsFlex = true,\n    contentClassName,\n    contentRef,\n    minHeight = 'min-h-440',\n  } = props;\n\n  return (\n    <div\n      className={clsx(\n        'bg border rounded h-full flex flex-col flex-auto',\n        minHeight,\n        className\n      )}\n    >\n      <div className=\"text-xs p-14 flex-shrink-0 flex justify-between items-center\">\n        <div className=\"font-semibold text-sm\">{title}</div>\n        {description && <div className=\"text-muted\">{description}</div>}\n      </div>\n      <div\n        ref={contentRef}\n        className={clsx(\n          'p-14 relative',\n          contentIsFlex && 'flex-auto flex items-center justify-center',\n          contentClassName\n        )}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}\n","import {ProgressCircle} from '@common/ui/progress/progress-circle';\nimport {Trans} from '@common/i18n/trans';\n\nexport function ChartLoadingIndicator() {\n  return (\n    <div className=\"flex items-center gap-10 text-sm absolute mx-auto\">\n      <ProgressCircle isIndeterminate size=\"sm\" />\n      <Trans message=\"Chart loading\" />\n    </div>\n  );\n}\n","import type {ChartData, ChartOptions, ChartType} from 'chart.js';\nimport {lazy, Suspense} from 'react';\nimport {ChartLayout, ChartLayoutProps} from './chart-layout';\nimport {ChartLoadingIndicator} from '@common/charts/chart-loading-indicator';\n\nconst LazyChart = lazy(() => import('./lazy-chart'));\n\nexport interface BaseChartProps<Type extends ChartType = ChartType>\n  extends Omit<ChartLayoutProps, 'children'> {\n  type: Type;\n  data: ChartData<Type, unknown>;\n  options?: ChartOptions<Type>;\n  hideLegend?: boolean;\n}\nexport function BaseChart<Type extends ChartType = ChartType>(\n  props: BaseChartProps<Type>\n) {\n  const {title, description, className, contentRef, isLoading} = props;\n\n  return (\n    <ChartLayout\n      title={title}\n      description={description}\n      className={className}\n      contentRef={contentRef}\n    >\n      <Suspense fallback={<ChartLoadingIndicator />}>\n        <LazyChart {...props} />\n        {isLoading && <ChartLoadingIndicator />}\n      </Suspense>\n    </ChartLayout>\n  );\n}\n","import {DateFormatter, parseAbsoluteToLocal} from '@internationalized/date';\nimport memoize from 'nano-memoize';\nimport {ChartType} from 'chart.js';\nimport {\n  FormattedDatasetItem,\n  FormattedReportData,\n} from './formatted-dataset-item';\nimport {\n  DatasetItem,\n  RangedDatasetGranularity,\n  ReportMetric,\n} from '../../admin/analytics/report-metric';\nimport {shallowEqual} from '../../utils/shallow-equal';\n\ninterface Options {\n  localeCode: string;\n  shareFirstDatasetLabels?: boolean;\n}\n\ntype FormattedDatasetLabels = Omit<FormattedDatasetItem, 'value'>;\n\nexport function formatReportData(\n  report: ReportMetric | undefined,\n  {localeCode = 'en', shareFirstDatasetLabels = true}: Options\n): FormattedReportData {\n  if (!report) return {datasets: []};\n\n  const firstDatasetLabels: FormattedDatasetLabels[] = [];\n\n  return {\n    ...report,\n    datasets: report.datasets.map((dataset, datasetIndex) => {\n      const data = dataset.data.map((datasetItem, itemIndex) => {\n        let label: FormattedDatasetLabels;\n        // when there are multiple datasets, we'll need to use labels from the first dataset, so charts are\n        // overlapped over one another, otherwise they will be side by side, if labels in all datasets are not identical.\n        if (datasetIndex === 0 || !shareFirstDatasetLabels) {\n          label = generateDatasetLabels(\n            datasetItem,\n            report.granularity,\n            localeCode\n          );\n          firstDatasetLabels[itemIndex] = label;\n        } else {\n          label = firstDatasetLabels[itemIndex];\n        }\n        return {\n          ...label,\n          value: datasetItem.value,\n        };\n      });\n\n      return {...dataset, data};\n    }),\n  };\n}\n\nfunction generateDatasetLabels<T extends ChartType = ChartType>(\n  datum: DatasetItem,\n  granularity: RangedDatasetGranularity | undefined,\n  locale: string\n): FormattedDatasetLabels {\n  if (datum.label != null) {\n    return {label: datum.label};\n  }\n\n  if (!datum.date) {\n    return {label: ''};\n  }\n\n  return generateTimeLabels(datum, granularity, locale);\n}\n\nfunction generateTimeLabels(\n  {date: isoDate, endDate: isoEndDate, value}: DatasetItem,\n  granularity: RangedDatasetGranularity | undefined = 'day',\n  locale: string\n): Omit<FormattedDatasetItem, 'value'> {\n  const date = parseAbsoluteToLocal(isoDate).toDate();\n  const endDate = isoEndDate ? parseAbsoluteToLocal(isoEndDate).toDate() : null;\n\n  switch (granularity) {\n    case 'minute':\n      return {\n        label: getFormatter(locale, {\n          second: '2-digit',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          day: '2-digit',\n          hour: 'numeric',\n          minute: 'numeric',\n          second: '2-digit',\n        }).format(date),\n      };\n    case 'hour':\n      return {\n        label: getFormatter(locale, {\n          hour: 'numeric',\n          minute: 'numeric',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          month: 'short',\n          day: '2-digit',\n          hour: 'numeric',\n          minute: 'numeric',\n        }).format(date),\n      };\n    case 'day':\n      return {\n        label: getFormatter(locale, {\n          day: '2-digit',\n          weekday: 'short',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          day: '2-digit',\n          weekday: 'short',\n          month: 'short',\n        }).format(date),\n      };\n    case 'week':\n      return {\n        label: getFormatter(locale, {\n          month: 'short',\n          day: '2-digit',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          day: '2-digit',\n          month: 'long',\n          year: 'numeric',\n        }).formatRange(date, endDate as Date),\n      };\n    case 'month':\n      return {\n        label: getFormatter(locale, {\n          month: 'short',\n          year: 'numeric',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          month: 'long',\n          year: 'numeric',\n        }).format(date),\n      };\n    case 'year':\n      return {\n        label: getFormatter(locale, {\n          year: 'numeric',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          year: 'numeric',\n        }).format(date),\n      };\n  }\n}\n\nconst getFormatter = memoize(\n  (locale, options: Intl.DateTimeFormatOptions) => {\n    return new DateFormatter(locale, options);\n  },\n  {\n    equals: (a, b) => {\n      return shallowEqual(a, b);\n    },\n    callTimeout: undefined as any,\n  }\n);\n","import {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\n\nconst primaryColor = getBootstrapData().themes.all[0].colors['--be-primary'];\nexport const ChartColors = [\n  [\n    `rgb(${primaryColor.replaceAll(' ', ',')})`,\n    `rgba(${primaryColor.replaceAll(' ', ',')},0.2)`,\n  ],\n  ['rgb(255,112,67)', 'rgb(255,112,67,0.2)'],\n  ['rgb(255,167,38)', 'rgb(255,167,38,0.2)'],\n  ['rgb(141,110,99)', 'rgb(141,110,99,0.2)'],\n  ['rgb(102,187,106)', 'rgba(102,187,106,0.2)'],\n  ['rgb(92,107,192)', 'rgb(92,107,192,0.2)'],\n];\n","import {BaseChart, BaseChartProps} from './base-chart';\nimport {ReportMetric} from '../admin/analytics/report-metric';\nimport {useMemo} from 'react';\nimport {formatReportData} from './data/format-report-data';\nimport {useSelectedLocale} from '../i18n/selected-locale';\nimport {ChartData, ChartOptions} from 'chart.js';\nimport {ChartColors} from './chart-colors';\nimport {FormattedDatasetItem} from './data/formatted-dataset-item';\nimport clsx from 'clsx';\n\nconst LineChartOptions: ChartOptions<'line'> = {\n  parsing: {\n    xAxisKey: 'label',\n    yAxisKey: 'value',\n  },\n  datasets: {\n    line: {\n      fill: 'origin',\n      tension: 0.1,\n      pointBorderWidth: 4,\n      pointHitRadius: 10,\n    },\n  },\n  plugins: {\n    tooltip: {\n      intersect: false,\n      mode: 'index',\n    },\n  },\n};\n\ninterface LineChartProps extends Omit<BaseChartProps<'line'>, 'type' | 'data'> {\n  data?: ReportMetric;\n}\nexport function LineChart({data, className, ...props}: LineChartProps) {\n  const {localeCode} = useSelectedLocale();\n  const formattedData: ChartData<'line', FormattedDatasetItem[]> =\n    useMemo(() => {\n      const formattedData = formatReportData(data, {localeCode});\n      formattedData.datasets = formattedData.datasets.map((dataset, i) => ({\n        ...dataset,\n        backgroundColor: ChartColors[i][1],\n        borderColor: ChartColors[i][0],\n        pointBackgroundColor: ChartColors[i][0],\n      }));\n      return formattedData;\n    }, [data, localeCode]);\n\n  return (\n    <BaseChart\n      {...props}\n      className={clsx(className, 'min-w-500')}\n      data={formattedData}\n      type=\"line\"\n      options={LineChartOptions}\n    />\n  );\n}\n","import {BaseChart, BaseChartProps} from './base-chart';\nimport {ChartData, ChartOptions} from 'chart.js';\nimport {ChartColors} from './chart-colors';\nimport {useSelectedLocale} from '../i18n/selected-locale';\nimport {useMemo} from 'react';\nimport {formatReportData} from './data/format-report-data';\nimport {ReportMetric} from '../admin/analytics/report-metric';\nimport {FormattedDatasetItem} from './data/formatted-dataset-item';\nimport clsx from 'clsx';\n\nconst PolarAreaChartOptions: ChartOptions<'polarArea'> = {\n  parsing: {\n    key: 'value',\n  },\n  plugins: {\n    tooltip: {\n      intersect: true,\n    },\n  },\n};\n\ninterface PolarAreaChartProps\n  extends Omit<BaseChartProps<'polarArea'>, 'type' | 'data'> {\n  data?: ReportMetric;\n}\nexport function PolarAreaChart({\n  data,\n  className,\n  ...props\n}: PolarAreaChartProps) {\n  const {localeCode} = useSelectedLocale();\n  const formattedData: ChartData<'polarArea', FormattedDatasetItem[]> =\n    useMemo(() => {\n      const formattedData = formatReportData(data, {localeCode});\n      formattedData.labels = formattedData.datasets[0]?.data.map(d => d.label);\n      formattedData.datasets = formattedData.datasets.map((dataset, i) => ({\n        ...dataset,\n        backgroundColor: ChartColors.map(c => c[1]),\n        borderColor: ChartColors.map(c => c[0]),\n        borderWidth: 2,\n      }));\n      return formattedData;\n    }, [data, localeCode]);\n\n  return (\n    <BaseChart\n      type=\"polarArea\"\n      data={formattedData}\n      options={PolarAreaChartOptions}\n      className={clsx(className, 'min-w-500')}\n      {...props}\n    />\n  );\n}\n","import {BaseChart, BaseChartProps} from './base-chart';\nimport {ChartData, ChartOptions} from 'chart.js';\nimport {ChartColors} from './chart-colors';\nimport {useSelectedLocale} from '../i18n/selected-locale';\nimport {FormattedDatasetItem} from './data/formatted-dataset-item';\nimport {useMemo} from 'react';\nimport {formatReportData} from './data/format-report-data';\nimport {ReportMetric} from '../admin/analytics/report-metric';\nimport clsx from 'clsx';\n\ninterface BarChartProps extends Omit<BaseChartProps<'bar'>, 'type' | 'data'> {\n  direction?: 'horizontal' | 'vertical';\n  individualBarColors?: boolean;\n  data?: ReportMetric;\n}\nexport function BarChart({\n  data,\n  direction = 'vertical',\n  individualBarColors = false,\n  className,\n  ...props\n}: BarChartProps) {\n  const {localeCode} = useSelectedLocale();\n  const formattedData: ChartData<'bar', FormattedDatasetItem[]> =\n    useMemo(() => {\n      const formattedData = formatReportData(data, {localeCode});\n      formattedData.datasets = formattedData.datasets.map((dataset, i) => ({\n        ...dataset,\n        backgroundColor: individualBarColors\n          ? ChartColors.map(c => c[1])\n          : ChartColors[i][1],\n        borderColor: individualBarColors\n          ? ChartColors.map(c => c[0])\n          : ChartColors[i][0],\n        borderWidth: 2,\n      }));\n      return formattedData;\n    }, [data, localeCode, individualBarColors]);\n\n  const isHorizontal = direction === 'horizontal';\n  const options: ChartOptions<'bar'> = useMemo(() => {\n    return {\n      indexAxis: isHorizontal ? 'y' : 'x',\n      parsing: {\n        xAxisKey: isHorizontal ? 'value' : 'label',\n        yAxisKey: isHorizontal ? 'label' : 'value',\n      },\n    };\n  }, [isHorizontal]);\n\n  return (\n    <BaseChart\n      type=\"bar\"\n      className={clsx(className, 'min-w-500')}\n      data={formattedData}\n      options={options}\n      {...props}\n    />\n  );\n}\n","import lazyLoader from '../../../utils/http/lazy-loader';\nimport {useSettings} from '@common/core/settings/use-settings';\nimport {RefObject, useCallback, useEffect, useRef} from 'react';\nimport {useThemeSelector} from '@common/ui/themes/theme-selector-context';\nimport {themeValueToHex} from '@common/ui/themes/utils/theme-value-to-hex';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport {LocationDatasetItem} from '@common/admin/analytics/report-metric';\n\nconst loaderUrl = 'https://www.gstatic.com/charts/loader.js';\n\ninterface UseGoogleGeoChartProps {\n  placeholderRef: RefObject<HTMLDivElement>;\n  data: LocationDatasetItem[];\n  onCountrySelected?: (countryCode: string) => void;\n  country?: string;\n}\nexport function useGoogleGeoChart({\n  placeholderRef,\n  data,\n  country,\n  onCountrySelected,\n}: UseGoogleGeoChartProps) {\n  const {trans} = useTrans();\n  const {analytics} = useSettings();\n  const apiKey = analytics?.gchart_api_key;\n  const {selectedTheme} = useThemeSelector();\n  const geoChartRef = useRef<google.visualization.GeoChart>();\n  // only allow selecting countries, not cities\n  const regionInteractivity = !!onCountrySelected && !country;\n  const drawGoogleChart = useCallback(() => {\n    if (typeof google === 'undefined') return;\n\n    const seedData = data.map(location => [location.label, location.value]);\n    seedData.unshift([\n      country ? trans(message('City')) : trans(message('Country')),\n      trans(message('Clicks')),\n    ]);\n\n    const backgroundColor = `${themeValueToHex(\n      selectedTheme.colors['--be-paper']\n    )}`;\n    const chartColor = `${themeValueToHex(\n      selectedTheme.colors['--be-primary']\n    )}`;\n\n    const options: google.visualization.GeoChartOptions = {\n      colorAxis: {colors: [chartColor]},\n      backgroundColor,\n      region: country ? country.toUpperCase() : undefined,\n      resolution: country ? 'provinces' : 'countries',\n      displayMode: country ? 'markers' : 'regions',\n      enableRegionInteractivity: regionInteractivity,\n    };\n\n    if (\n      !geoChartRef.current &&\n      placeholderRef.current &&\n      google?.visualization?.GeoChart\n    ) {\n      geoChartRef.current = new google.visualization.GeoChart(\n        placeholderRef.current\n      );\n    }\n    geoChartRef.current?.draw(\n      google.visualization.arrayToDataTable(seedData),\n      options\n    );\n  }, [\n    selectedTheme,\n    data,\n    placeholderRef,\n    trans,\n    country,\n    regionInteractivity,\n  ]);\n\n  const initGoogleGeoChart = useCallback(async () => {\n    if (lazyLoader.isLoadingOrLoaded(loaderUrl)) return;\n    await lazyLoader.loadAsset(loaderUrl, {type: 'js'});\n    await google.charts.load('current', {\n      packages: ['geochart'],\n      mapsApiKey: apiKey,\n    });\n    drawGoogleChart();\n  }, [apiKey, drawGoogleChart]);\n\n  useEffect(() => {\n    if (geoChartRef.current && onCountrySelected) {\n      google.visualization.events.addListener(\n        geoChartRef.current,\n        'regionClick',\n        (a: {region: string}) => onCountrySelected?.(a.region)\n      );\n    }\n\n    return () => {\n      if (geoChartRef.current) {\n        google.visualization.events.removeAllListeners(geoChartRef.current);\n      }\n    };\n    // this will correctly run when geochart instance is set on ref\n  }, [onCountrySelected, geoChartRef.current]);\n\n  // on component load: load chart library then draw, otherwise just draw\n  useEffect(() => {\n    initGoogleGeoChart();\n  }, [initGoogleGeoChart]);\n\n  // redraw chart if data or theme changes\n  useEffect(() => {\n    drawGoogleChart();\n  }, [selectedTheme, drawGoogleChart, data]);\n\n  return {drawGoogleChart};\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const InfoDialogTriggerIcon = createSvgIcon(\n  <path d=\"M9 8a1 1 0 0 0-1-1H5.5a1 1 0 1 0 0 2H7v4a1 1 0 0 0 2 0zM4 0h8a4 4 0 0 1 4 4v8a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4zm4 5.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z\" />,\n  'InfoDialogTrigger'\n);\n","import {IconButton} from '@common/ui/buttons/icon-button';\nimport {InfoDialogTriggerIcon} from '@common/ui/overlays/dialog/info-dialog-trigger/info-dialog-trigger-icon';\nimport {Dialog, DialogSize} from '@common/ui/overlays/dialog/dialog';\nimport {DialogHeader} from '@common/ui/overlays/dialog/dialog-header';\nimport {DialogBody} from '@common/ui/overlays/dialog/dialog-body';\nimport {DialogTrigger} from '@common/ui/overlays/dialog/dialog-trigger';\nimport React, {ReactNode} from 'react';\nimport clsx from 'clsx';\n\ninterface InfoDialogTriggerProps {\n  title?: ReactNode;\n  body: ReactNode;\n  dialogSize?: DialogSize;\n  className?: string;\n}\nexport function InfoDialogTrigger({\n  title,\n  body,\n  dialogSize = 'sm',\n  className,\n}: InfoDialogTriggerProps) {\n  return (\n    <DialogTrigger type=\"popover\" triggerOnHover>\n      <IconButton\n        className={clsx('text-muted opacity-70', className)}\n        size=\"xs\"\n      >\n        <InfoDialogTriggerIcon viewBox=\"0 0 16 16\" />\n      </IconButton>\n      <Dialog size={dialogSize}>\n        {title && (\n          <DialogHeader padding=\"px-18 pt-12\" size=\"md\" hideDismissButton>\n            {title}\n          </DialogHeader>\n        )}\n        <DialogBody>{body}</DialogBody>\n      </Dialog>\n    </DialogTrigger>\n  );\n}\n","import {useSelectedLocale} from '@common/i18n/selected-locale';\nimport {Fragment, memo} from 'react';\n\ninterface Props {\n  code: string;\n}\nexport const FormattedCountryName = memo(({code: countryCode}: Props) => {\n  const {localeCode} = useSelectedLocale();\n  const regionNames = new Intl.DisplayNames([localeCode], {type: 'region'});\n  let formattedName: string | undefined;\n\n  try {\n    formattedName = regionNames.of(countryCode.toUpperCase());\n  } catch (e) {}\n\n  return <Fragment>{formattedName}</Fragment>;\n});\n","import {\n  LocationDatasetItem,\n  ReportMetric,\n} from '@common/admin/analytics/report-metric';\nimport React, {useMemo, useRef} from 'react';\nimport {useGoogleGeoChart} from './use-google-geo-chart';\nimport {ChartLayout, ChartLayoutProps} from '@common/charts/chart-layout';\nimport {Trans} from '@common/i18n/trans';\nimport {ChartLoadingIndicator} from '@common/charts/chart-loading-indicator';\nimport {Button} from '@common/ui/buttons/button';\nimport {ArrowBackIcon} from '@common/icons/material/ArrowBack';\nimport clsx from 'clsx';\nimport {InfoDialogTrigger} from '@common/ui/overlays/dialog/info-dialog-trigger/info-dialog-trigger';\nimport {FormattedCountryName} from '@common/i18n/formatted-country-name';\n\ninterface GeoChartData extends Partial<ChartLayoutProps> {\n  data?: ReportMetric<LocationDatasetItem>;\n  onCountrySelected?: (countryCode: string | undefined) => void;\n  country?: string;\n}\nexport function GeoChart({\n  data: metricData,\n  isLoading,\n  onCountrySelected,\n  country,\n  ...layoutProps\n}: GeoChartData) {\n  const placeholderRef = useRef<HTMLDivElement>(null);\n  const regionInteractivity = !!onCountrySelected;\n\n  // memo data to avoid redrawing chart on rerender\n  const initialData = metricData?.datasets[0].data;\n  const data = useMemo(() => {\n    return initialData || [];\n  }, [initialData]);\n  useGoogleGeoChart({placeholderRef, data, country, onCountrySelected});\n\n  return (\n    <ChartLayout\n      {...layoutProps}\n      className=\"min-w-500\"\n      title={\n        <div className=\"flex items-center\">\n          <Trans message=\"Top Locations\" />\n          {country ? (\n            <span className=\"pl-4\">\n              ({<FormattedCountryName code={country} />})\n            </span>\n          ) : null}\n          {regionInteractivity && <InfoTrigger />}\n        </div>\n      }\n      contentIsFlex={isLoading}\n    >\n      {isLoading && <ChartLoadingIndicator />}\n      <div className=\"flex gap-24\">\n        <div\n          ref={placeholderRef}\n          className=\"flex-auto w-[480px] min-h-[340px]\"\n        />\n        <div className=\"w-[170px]\">\n          <div className=\"text-sm max-h-[340px] w-full flex-initial overflow-y-auto\">\n            {data.map(location => (\n              <div\n                key={location.label}\n                className={clsx(\n                  'flex items-center gap-4 mb-4',\n                  regionInteractivity && 'cursor-pointer hover:underline'\n                )}\n                role={regionInteractivity ? 'button' : undefined}\n                onClick={() => {\n                  onCountrySelected?.(location.code);\n                }}\n              >\n                <div className=\"max-w-110 whitespace-nowrap overflow-hidden overflow-ellipsis\">\n                  {location.label}\n                </div>\n                <div>({location.percentage})%</div>\n              </div>\n            ))}\n          </div>\n          {country && (\n            <Button\n              variant=\"outline\"\n              size=\"xs\"\n              className=\"mt-14\"\n              startIcon={<ArrowBackIcon />}\n              onClick={() => {\n                onCountrySelected?.(undefined);\n              }}\n            >\n              <Trans message=\"Back to countries\" />\n            </Button>\n          )}\n        </div>\n      </div>\n    </ChartLayout>\n  );\n}\n\nfunction InfoTrigger() {\n  return (\n    <InfoDialogTrigger\n      title={<Trans message=\"Zooming in\" />}\n      body={\n        <Trans message=\"Click on a country inside the map or country list to zoom in and see city data for that country.\" />\n      }\n    />\n  );\n}\n","import React, {Fragment} from 'react';\nimport {LineChart} from '@common/charts/line-chart';\nimport {Trans} from '@common/i18n/trans';\nimport {PolarAreaChart} from '@common/charts/polar-area-chart';\nimport {BarChart} from '@common/charts/bar-chart';\nimport {VisitorsReportData} from '@common/admin/analytics/visitors-report-data';\nimport {FormattedNumber} from '@common/i18n/formatted-number';\nimport {GeoChart} from '@common/admin/analytics/geo-chart/geo-chart';\n\nexport const AdminReportPageColGap = 'gap-12 md:gap-24 mb-12 md:mb-24';\nconst rowClassName = `flex flex-col md:flex-row md:items-center overflow-x-auto ${AdminReportPageColGap}`;\n\ninterface AdminReportChartsProps {\n  report?: VisitorsReportData;\n  isLoading: boolean;\n}\nexport function VisitorsReportCharts({\n  report,\n  isLoading,\n}: AdminReportChartsProps) {\n  const totalViews = report?.pageViews.total;\n  return (\n    <Fragment>\n      <div className={rowClassName}>\n        <LineChart\n          isLoading={isLoading}\n          className=\"flex-auto\"\n          data={report?.pageViews}\n          title={<Trans message=\"Pageviews\" />}\n          description={\n            totalViews ? (\n              <Trans\n                message=\":count total views\"\n                values={{count: <FormattedNumber value={totalViews} />}}\n              />\n            ) : null\n          }\n        />\n        <PolarAreaChart\n          isLoading={isLoading}\n          data={report?.devices}\n          title={<Trans message=\"Top devices\" />}\n        />\n      </div>\n      <div className={rowClassName}>\n        <BarChart\n          isLoading={isLoading}\n          data={report?.browsers}\n          className=\"flex-auto md:w-1/3\"\n          direction=\"horizontal\"\n          individualBarColors\n          hideLegend\n          title={<Trans message=\"Top browsers\" />}\n        />\n        <GeoChart\n          isLoading={isLoading}\n          className=\"flex-auto\"\n          data={report?.locations}\n          title={<Trans message=\"Top locations\" />}\n        />\n      </div>\n    </Fragment>\n  );\n}\n","import {HeaderDatum} from '@common/admin/analytics/use-admin-report';\nimport React, {Fragment, ReactElement} from 'react';\nimport {TrendingUpIcon} from '@common/icons/material/TrendingUp';\nimport {TrendingDownIcon} from '@common/icons/material/TrendingDown';\nimport {createSvgIconFromTree} from '@common/icons/create-svg-icon';\nimport {AdminReportPageColGap} from '@common/admin/analytics/visitors-report-charts';\nimport {DateRangeValue} from '@common/ui/forms/input-field/date/date-range-picker/date-range-value';\nimport {FormattedDateTimeRange} from '@common/i18n/formatted-date-time-range';\nimport {FormattedNumber} from '@common/i18n/formatted-number';\nimport {FormattedBytes} from '@common/uploads/formatted-bytes';\nimport {TrendingFlatIcon} from '@common/icons/material/TrendingFlat';\n\ninterface AdminHeaderReportProps {\n  report?: HeaderDatum[];\n  dateRange: DateRangeValue;\n}\nexport function AdminHeaderReport({report, dateRange}: AdminHeaderReportProps) {\n  const label = (\n    <FormattedDateTimeRange start={dateRange.start} end={dateRange.end} />\n  );\n\n  return (\n    <div\n      className={`flex items-center flex-shrink-0 overflow-x-auto h-[97px] ${AdminReportPageColGap}`}\n    >\n      {report?.map(datum => (\n        <ValueMetricItem key={datum.name} datum={datum} />\n      ))}\n    </div>\n  );\n}\n\ninterface ValueMetricItemProps {\n  datum: HeaderDatum;\n  label?: ReactElement;\n}\nfunction ValueMetricItem({datum, label}: ValueMetricItemProps) {\n  const Icon = createSvgIconFromTree(datum.icon);\n\n  return (\n    <div\n      key={datum.name}\n      className=\"flex items-center flex-auto rounded border p-20 gap-18 h-full whitespace-nowrap\"\n    >\n      <div className=\"bg-primary-light/20 rounded-lg p-10 flex-shrink-0\">\n        <Icon size=\"lg\" className=\"text-primary\" />\n      </div>\n      <div className=\"flex-auto\">\n        <div className=\"flex items-center gap-20 justify-between\">\n          <div className=\"text-main text-lg font-bold\">\n            {datum.type === 'fileSize' ? (\n              <FormattedBytes bytes={datum.currentValue} />\n            ) : (\n              <FormattedNumber value={datum.currentValue} />\n            )}\n          </div>\n          {label && <div className=\"text-xs text-muted ml-auto\">{label}</div>}\n        </div>\n        <div className=\"flex items-center gap-20 justify-between\">\n          <h2 className=\"text-muted text-sm\">{datum.name}</h2>\n          {datum.percentageChange != null && (\n            <div className=\"flex items-center gap-10\">\n              <TrendingIndicator percentage={datum.percentageChange} />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface TrendingIndicatorProps {\n  percentage: number;\n}\n\nfunction TrendingIndicator({percentage}: TrendingIndicatorProps) {\n  let icon: ReactElement;\n  if (percentage > 0) {\n    icon = <TrendingUpIcon size=\"md\" className=\"text-positive\" />;\n  } else if (percentage === 0) {\n    icon = <TrendingFlatIcon className=\"text-muted\" />;\n  } else {\n    icon = <TrendingDownIcon className=\"text-danger\" />;\n  }\n\n  return (\n    <Fragment>\n      {icon}\n      <div className=\"text-sm font-semibold text-muted\">{percentage}%</div>\n    </Fragment>\n  );\n}\n","import {useDateRangePickerState} from '@common/ui/forms/input-field/date/date-range-picker/use-date-range-picker-state';\nimport {DialogTrigger} from '@common/ui/overlays/dialog/dialog-trigger';\nimport {Button} from '@common/ui/buttons/button';\nimport {DateRangeIcon} from '@common/icons/material/DateRange';\nimport {FormattedDateTimeRange} from '@common/i18n/formatted-date-time-range';\nimport {DateRangeDialog} from '@common/ui/forms/input-field/date/date-range-picker/dialog/date-range-dialog';\nimport React from 'react';\nimport {DateRangeValue} from '@common/ui/forms/input-field/date/date-range-picker/date-range-value';\nimport {useIsMobileMediaQuery} from '@common/utils/hooks/is-mobile-media-query';\nimport {DateFormatPresets} from '@common/i18n/formatted-date';\n\nconst monthDayFormat: Intl.DateTimeFormatOptions = {\n  month: 'short',\n  day: '2-digit',\n};\n\ninterface ReportDataSelectorProps {\n  value: DateRangeValue;\n  onChange: (value: DateRangeValue) => void;\n  compactOnMobile?: boolean;\n}\nexport function ReportDateSelector({\n  value,\n  onChange,\n  compactOnMobile = true,\n}: ReportDataSelectorProps) {\n  const isMobile = useIsMobileMediaQuery();\n  return (\n    <DialogTrigger\n      type=\"popover\"\n      onClose={value => {\n        if (value) {\n          onChange(value);\n        }\n      }}\n    >\n      <Button variant=\"outline\" color=\"chip\" endIcon={<DateRangeIcon />}>\n        <FormattedDateTimeRange\n          start={value.start}\n          end={value.end}\n          options={\n            isMobile && compactOnMobile\n              ? monthDayFormat\n              : DateFormatPresets.short\n          }\n        />\n      </Button>\n      <DateSelectorDialog value={value} />\n    </DialogTrigger>\n  );\n}\n\ninterface DateSelectorDialogProps {\n  value: DateRangeValue;\n}\nfunction DateSelectorDialog({value}: DateSelectorDialogProps) {\n  const isMobile = useIsMobileMediaQuery();\n  const state = useDateRangePickerState({\n    defaultValue: value,\n    closeDialogOnSelection: false,\n  });\n  return (\n    <DateRangeDialog state={state} showInlineDatePickerField={!isMobile} />\n  );\n}\n","import React, {useState} from 'react';\nimport {useAdminReport} from './use-admin-report';\nimport {Trans} from '../../i18n/trans';\nimport {StaticPageTitle} from '../../seo/static-page-title';\nimport {AdminHeaderReport} from '@common/admin/analytics/admin-header-report';\nimport {VisitorsReportCharts} from '@common/admin/analytics/visitors-report-charts';\nimport {DateRangeValue} from '@common/ui/forms/input-field/date/date-range-picker/date-range-value';\nimport {DateRangePresets} from '@common/ui/forms/input-field/date/date-range-picker/dialog/date-range-presets';\nimport {ReportDateSelector} from '@common/admin/analytics/report-date-selector';\n\nexport default function AdminReportPage() {\n  const [dateRange, setDateRange] = useState<DateRangeValue>(() => {\n    // This week\n    return DateRangePresets[2].getRangeValue();\n  });\n  const {isLoading, data} = useAdminReport({dateRange});\n  const title = <Trans message=\"Visitors report\" />;\n\n  return (\n    <div className=\"min-h-full gap-12 md:gap-24 p-12 md:p-24 overflow-x-hidden\">\n      <div className=\"md:flex items-center justify-between gap-24 mb-24\">\n        <StaticPageTitle>{title}</StaticPageTitle>\n        <h1 className=\"mb-24 md:mb-0 text-3xl font-light\">{title}</h1>\n        <ReportDateSelector value={dateRange} onChange={setDateRange} />\n      </div>\n      <AdminHeaderReport report={data?.headerReport} dateRange={dateRange} />\n      <VisitorsReportCharts\n        report={data?.visitorsReport}\n        isLoading={isLoading}\n      />\n    </div>\n  );\n}\n"],"file":"assets/admin-report-page-2bb6a3e0.js"}